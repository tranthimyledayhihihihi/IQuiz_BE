@{
    ViewBag.Title = "Tham gia phòng đấu trường";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="game-container">
    <h2 class="text-white mb-4">Tham gia phòng</h2>

    <div class="card p-4" style="max-width: 400px;">
        <label for="txtRoomCode" class="form-label">Nhập mã phòng</label>
        <input type="text" id="txtRoomCode" class="form-control" placeholder="ABC123" />

        <div id="joinError" class="text-danger mt-2" style="display:none;"></div>

        <button id="btnJoinRoom" class="btn btn-primary mt-3">
            Tham gia
        </button>
    </div>
</div>

@section Scripts {
    <script>
    $(function () {
        $("#btnJoinRoom").on("click", function () {
            var code = $("#txtRoomCode").val().trim();
            if (!code) {
                $("#joinError").text("Vui lòng nhập mã phòng.").show();
                return;
            }

            $.ajax({
                url: "@Url.Action("JoinRoom", "Arena")",
                type: "POST",
                data: { code: code },
                success: function (res) {
                    if (res.success === false) {
                        $("#joinError").text(res.message || "Tham gia thất bại.").show();
                        return;
                    }

                    alert("Tham gia phòng thành công!");

                    // Sau này có thể redirect sang màn chơi cụ thể theo roomId
                    // ví dụ: window.location.href = "/Quiz/Play?roomId=" + res.roomId;
                },
                error: function (xhr) {
                    $("#joinError").text("Lỗi server: " + xhr.responseText).show();
                }
            });
        });
    });
    </script>
}
